{% extends 'base.html.twig' %}

{% block title %}User{% endblock %}

{% block body %}
    <div hidden>{{ user.id }}</div>

    <div class="container">
        <div class="row mb-5">
            <h3 class="text-center col-12 border-bottom border-primary">Bienvenue {{ user.firstname }}</h3>
        </div>

        <div class="row">
            {#  navigation dans les diefférents onglets accesibles par l'adherent#}
            <div class="col-12 col-lg-12">
                {#  navigation dans les différentes zones 3 en initiales#}
                <section id="tabs" class="project-tab">

                    <div class="col-lg-12">
                        <nav>
                            <div class="nav nav-tabs nav-fill" id="nav-tab" role="tablist">
                                <a class="nav-item nav-link active" id="nav-contact-tab" data-toggle="tab"
                                   href="#nav-account" role="tab" aria-controls="nav-contact"
                                   aria-selected="false">Mon compte</a>
                                <a class="nav-item nav-link " id="nav-home-tab" data-toggle="tab"
                                   href="#nav-home" role="tab" aria-controls="nav-home" aria-selected="true">Mon
                                    inscription</a>
                                <a class="nav-item nav-link" id="nav-contact-tab" data-toggle="tab"
                                   href="#nav-contact" role="tab" aria-controls="nav-contact"
                                   aria-selected="false">Les sorties</a>
                                <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab"
                                   href="#nav-profile" role="tab" aria-controls="nav-profile"
                                   aria-selected="false">Mes documents</a>
                            </div>
                        </nav>

                        <div class="tab-content" id="nav-tabContent">

                            {#  affichage du compte de l'utlisteu#}
                            <div class="tab-pane fade show active" id="nav-account" role="tabpanel"
                                 aria-labelledby="nav-home-tab">
                                <div class="card mb-3" style="max-width: 100%;">
                                    <div class="row no-gutters">
                                        <div class="col-md-4">
                                            {% if user.picture is null %}
                                                <img src="" class="card-img" alt="...">
                                            {% else %}
                                                <img src="{{ '/uploads/images/' ~ user.picture }}"
                                                     class="card-img" alt="...">
                                            {% endif %}
                                        </div>
                                        <div class="col-md-8">
                                            <div class="card-body">
                                                <h5 class="card-title font-weight-bold">{{ user.firstname }} {{ user.lastname }}</h5>
                                                <p class="card-text">mail:{{ user.email }} </p>
                                                <p class="card-text">Téléphone:{{ user.homePhone }} </p>
                                                <p class="card-text">Mobile:{{ user.mobilePhone }} </p>
                                                <p class="card-text">Adresse:{{ user.address }} </p>
                                                <p class="card-text">{{ user.zipCode }} {{ user.city }} </p>
                                                <p class="card-text">Date
                                                    naissance:{{ user.birthday ? user.birthday|date('Y-m-d') : '' }} </p>
                                            </div>
                                        </div>
                                    </div>
                                    {#   gestion si membre inscrit ou pas. si  inscrit info inscription ,si pas inscript
                                    on renvoi la validation de l'inscription #}
                                    <div class="card-footer bg-transparent border-success">
                                        <a href="{{ path('user_edit', {'id': user.id}) }}" class="btn btn-primary text-white">Modifiez
                                            vos informations</a>

                                    </div>
                                </div>
                            </div>




                            {#  affichage du statut de l'inscription onglet mon inscription#}
                            <div class="tab-pane fade show" id="nav-home" role="tabpanel"
                                 aria-labelledby="nav-home-tab">

{#                                si pas inscrit on affiche le lien vers le form d'inscription: si inscrit info de l'inscription#}
                                {% if user.inscriptions is empty  %}
                                    <div><a href="{{ path('inscriptionForm') }}">S'inscrire</a></div>

                                {% else %}


                                    {% for inscr in user.inscriptions %}

                                    <div class="mt-3">Ma periode d'inscription :
                                        <strong>{{ inscr.inscriptionYear }}</strong></div>
                                    <div class="mt-3">Statut de votre inscription:
                                        <strong>{{ inscr.inscriptionStatus.name }}</strong></div>
                                    <h4 class="mt-3"><strong>Rôle et activités:</strong></h4>
                                    <ul style="list-style: square;">
                                        {% if user.isMonitor %}
                                            <li>{{ 'Moniteur: niveau ' ~ user.level.name }}</li>
                                        {% endif %}
                                        {% if user.isDiver %}
                                            <li>{{ 'Adhérent plongeur: niveau ' ~ user.level.name }}</li>
                                        {% endif %}
                                        {% if user.isSwim %}
                                            <li>{{ 'Adhérent nageur' }}</li>
                                        {% endif %}
                                        {% if user.isAdmin %}
                                            <li>{{ 'Authorisation: administration du site' }}</li>
                                        {% endif %}
                                    </ul>
                                    <h4 class="mt-3"><strong>Droits à l'image</strong></h4>
                                    <div class="mt-2">
                                         {{ inscr.imageRight? 'Vous avez autorisé la diffusion d\'image' : 'Vous n\'avez autorisé pas la diffusion d\'image' }}</div>
                                    <h4 class="mt-3"><strong>un commentaire?</strong></h4>
                                    <div>{{ user.comment }}</div>
                                    {#    PAs d'afficahge du statut isHandi    #}
                                    {% endfor %}
{#                                    end if si insrit ou pas: #}
                                {% endif %}

                            </div>

                            {# affichage de la listes des sorties #}
                            <div class="tab-pane fade" id="nav-contact" role="tabpanel"
                            aria-labelledby="nav-contact-tab">
                                <h4 class="mt-3"><strong>Listes des sorties disponibles:</strong></h4>
                                {#                                         ajout  des sorties une par une : suelement celle en cours#}
                                {% for trip in trips %}
                                    {#                                            on cree une card  par trip #}
                                    <div class="card mb-3" style="max-width: 100%;">
                                        <div class="row no-gutters">
                                            <div class="col-md-4">
                                                {% if trip.picture is null %}
                                                    <img src="" class="card-img" alt="...">
                                                {% else %}
                                                    <img src="{{ '/uploads/images/' ~ trip.picture.url }}"
                                                         class="card-img" alt="...">
                                                {% endif %}
                                            </div>
                                            <div class="col-md-8">
                                                <div class="card-body">
                                                    <h5 class="card-title">Sortie: {{ trip.name }}</h5>
                                                       <h5> lieu: {{ trip.location }}</h5>
                                                    <p class="card-text">{{ trip.description }}</p>
                                                    <p class="card-text"><small
                                                                class="text-muted">du {{ trip.dateStart|date("d/m/Y") }}
                                                            au {{ trip.dateEnd|date("d/m/Y") }}</small></p>
                                                </div>
                                            </div>
                                        </div>
                                        {#   gestion si membre inscrit ou pas. si  inscrit info inscription ,si pas inscript
                                        on renvoi la validation de l'inscription #}
                                        <div class="card-footer bg-transparent border-success">
                                            <form method="POST">
                                                <input hidden name="user" value="{{ user.id }}"></input>
                                                <input hidden name="trip" value="{{ trip.id }}"></input>
                                                <button type="submit" class="btn btn-primary">M'inscrire
                                                </button>
                                            </form>
                                        </div>
                                    </div>

                                {% endfor %}
                            </div>

                            {#                                    affichage de la zone de telechargement des docs #}
{#                            TODO faire afficahge des lien à télécharge: 2 colonnes doc à uploader et doc en download#}
                            <div class="tab-pane fade" id="nav-profile" role="tabpanel"
                                 aria-labelledby="nav-profile-tab">
                                {#                                TODO ajouter liste des docs à télécharger en plus de ceux du menbres #}
                                {% if user.inscriptions is empty  %}
                                    <div class="mt-2">Aucun document disponible ( à revoir si besoin) </div>
                                {% else %}
                                    {% for inscr in user.inscriptions %}
                                        {#                                lien vers le téléchargemetn des docs uploadé par les menbres#}
                                        <div class="mt-2">Téléchargement du réglement intérieur</div>
                                        <a href="{{ inscr.internalProcedure }}">Télécharger</a>

                                        <div class="mt-2">Téléchargement de votre fiche inscription</div>
                                        <a href="{{ inscr.inscriptionSheet }}"> Télécharger</a>

                                        <div class="mt-2">Téléchargement de votre certificat médicale</div>
                                        <a href="{{ inscr.medicalCertificate }}"> Télécharger</a>
                                    {% endfor %}
                                {% endif %}
                            </div>

                        </div>
                    </div>

                </section>

            </div>
        </div>
    </div>


{% endblock %}

{% block footer %}
    {% include '_footer.html.twig' %}
{% endblock %}
